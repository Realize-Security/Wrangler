service-aliases:
  - services: "smb"
    aliases: ["microsoft-ds", "netbios-ssn", "cifs", "samba"]
  - services: "ssh"
    aliases: ["openssh", "ssh2", "secure-shell", "sftp"]
  - services: "http"
    aliases: ["www", "http-alt", "websocket", "https"]
  - services: "ftp"
    aliases: ["sftp", "ftps"]
  - services: "mssql"
    aliases: ["ms-sql-s"]
  - services: "rpc"
    aliases: ["rpcbind"]
  - services: "pop3"
    aliases: ["pop3s", "Dovecot pop3d"]
  - services: "smtp"
    aliases: ["smtps"]
  - services: "dns"
    aliases: ["domain", "BIND"]
  - services: "nfs"
    aliases: ["2-4 (RPC"]
  - services: "sip"
    aliases: ["sip-tls"]
  - services: "imap"
    aliases: [ "imaps" ]

# Define common args as array that can be referenced
common-nmap-args: &common-nmap-args
  - "--max-retries 3"
  - "-T4"
  - "--host-timeout 60m"

scope-assignment:
  - tool: "nmap"
    arg: "-iL"
    description: "Command line flag for assigning input file for Nmap."

scan-collection:
  - scan-item:
      description: "Ping scan for initial host discovery"
      tool: "nmap"
      args: "-sn -PS21,22,80,443,3389 -PA80,443 -PU40125 -PY80,443 -PE -PP -PM -v"
      host_discovery: true

  - scan-item:
      description: "TCP service discovery"
      tool: "nmap"
      args:
        - *common-nmap-args
        - "-p-"
        - "-v"
      service_discovery: true

  - scan-item:
      description: "UDP service discovery"
      tool: "nmap"
      args:
        - *common-nmap-args
        - "--top-ports 1000"
        - "-v"
      service_discovery: true
      protocol: "udp"

  - scan-item:
      description: "TCP all ports default scripts and versions"
      tool: "nmap"
      args:
        - *common-nmap-args
        - "-sTV"
      protocol: "tcp"
      scripts: ""

  - scan-item:
      description: "TCP all ports SSL ciphers"
      tool: "nmap"
      args:
        - *common-nmap-args
        - "-sT"
        - "--script ssl-enum-ciphers"
      protocol: "tcp"

  - scan-item:
      description: "TCP all ports and all SSL scripts"
      tool: "nmap"
      args:
        - *common-nmap-args
        - "-sT"
        - "--script 'ssl-*,sslv2-* and not ssl-enum-ciphers'"
      protocol: "tcp"

  - scan-item:
     description: "TCP UDP common admin interfaces"
     tool: "nmap"
     args:
       - *common-nmap-args
       - "-sTUV"
       - "-p T:20,21,22,3389,445,111,2049,512,513,514,U:69,161"
     protocol: "both"

  - scan-item:
      description: "SNMP all except brute on default 161"
      services: ["snmp"]
      tool: "nmap"
      args:
        - *common-nmap-args
        - "-sU"
        - "--script 'snmp-* and not snmp-brute.nse'"
      protocol: "udp"

  - scan-item:
      description: "TCP all ports for SSH algos"
      tool: "nmap"
      services: ["ssh"]
      args:
        - *common-nmap-args
        - "-sT"
        - "--script ssh2-enum-algos"
      protocol: "tcp"

  - scan-item:
      description: "TCP all ports for SSH all except algos"
      tool: "nmap"
      services: ["ssh"]
      args:
        - *common-nmap-args
        - "-sT"
        - "--script 'ssh-* and not (ssh2-enum-algos or ssh-brute)'"
      protocol: "tcp"

  - scan-item:
      description: "FTP scripts on all ports"
      tool: "nmap"
      services: ["ftp"]
      args:
        - *common-nmap-args
        - "-sT"
        - "--script 'ftp-* and not ftp-brute'"
      protocol: "tcp"

  - scan-item:
      description: "RDP scripts on all ports"
      tool: "nmap"
      services: ["rdp"]
      args:
        - *common-nmap-args
        - "-sT"
        - "--script rdp-*"
      protocol: "tcp"

  - scan-item:
      description: "SMB scripts on all ports"
      tool: "nmap"
      services: ["smb"]
      args:
        - *common-nmap-args
        - "-sT"
        - "--script smb-enum-*"
      protocol: "tcp"

  - scan-item:
      description: "NTP scripts on all ports"
      tool: "nmap"
      services: ["ntp"]
      args:
        - *common-nmap-args
        - "-sU"
        - "--script ntp-info,ntp-monlist"
      protocol: "udp"

  - scan-item:
      description: "LDAP and LDAPS enumeration"
      tool: "nmap"
      services: ["ldap"]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "-sT"
        - "--script 'ldap-* and not ldap-brute.nse'"

  - scan-item:
      description: "MSSQL enumeration"
      tool: "nmap"
      services: ["mssql"]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "-sT"
        - "--script 'ms-sql-* and not ms-sql-brute.nse'"

  - scan-item:
      description: "RPC enumeration"
      tool: "nmap"
      services: ["rpc"]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "-sT"
        - "--script 'rpc* and msrpc-enum.nse and not rpcap-brute.nse'"

  - scan-item:
      description: "RMI enumeration"
      tool: "nmap"
      services: ["rmi"]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "-sT"
        - "--script rmi-dumpregistry.nse"

  - scan-item:
      description: "NFS enumeration"
      tool: "nmap"
      services: ["nfs"]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "-sT"
        - "--script nfs-*"

  - scan-item:
      description: "NTP enumeration"
      tool: "nmap"
      services: ["ntp"]
      protocol: "udp"
      args:
        - *common-nmap-args
        - "-sU"
        - "--script ntp-*"

  - scan-item:
      description: "DNS enumeration"
      tool: "nmap"
      services: ["dns"]
      protocol: "both"
      args:
        - *common-nmap-args
        - "--script 'dns-* and not dns-brute'"

  - scan-item:
      description: "POP3 enumeration"
      tool: "nmap"
      services: ["pop3"]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "--script 'pop3-* and not pop3-brute'"

  - scan-item:
      description: "SMTP enumeration"
      tool: "nmap"
      services: ["smtp"]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "--script 'smtp-* and not smtp-brute'"

  - scan-item:
      description: "IMAP enumeration"
      tool: "nmap"
      services: [ "imap" ]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "--script 'imap-* and not imap-brute'"

  - scan-item:
      description: "SIP enumeration"
      tool: "nmap"
      services: [ "sip" ]
      protocol: "tcp"
      args:
        - *common-nmap-args
        - "--script 'sip-* and not sip-brute and not sip-call-spoof'"

  - scan-item:
      description: "TFTP enumeration"
      tool: "nmap"
      services: ["tftp"]
      protocol: "udp"
      args:
        - *common-nmap-args
        - "--script tftp-*"